#!/usr/bin/env bash

if [[ $# -eq 1 ]]; then
    selected_package=$1
else
    selected_package=$(find /home/potato/workplace -mindepth 4 -maxdepth 4 -type d -path "*/src/*" \
        | sed 's|.*/src/||' \
        | fzf)
fi

if [[ -z $selected_package ]]; then
    exit 0
fi

full_path=$(find /home/potato/workplace -mindepth 4 -maxdepth 4 -type d -path "*/src/$selected_package")

if [[ -z $full_path ]]; then
    echo "Error: Could not resolve the full path for selected package"
    exit 1
fi

cd "$full_path" || exit 1

exec $SHELL -l
